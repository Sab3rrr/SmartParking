# 居民信息数据模型设计说明
## 一、文档说明
- 设计对象：智慧社区居民信息管理系统里的居民信息
- 设计目标：定义系统中用于存储和操作居民信息的结构化数据模型
- 技术栈：Python、Pydantic库
- 设计原则：
  - 基于Pydantic库的BaseModel类，实现数据模型的定义和验证
  - 每个属性都有明确的类型注解，确保数据的类型安全
  - 提供必要的验证逻辑，如身份证号的校验、出生日期的范围检查等
- 身份证设计原则：
  - 身份证号必须是18位数字，前17位为有效数字，最后一位为校验位（可能是数字或X）
  - 校验位的计算方法：将前17位数字分别乘以对应的系数（7、9、10、5、8、4、2、1、6、3、7、9、10、5、8、4、2），将乘积相加，取模11的结果对应于校验位的位置
  - 校验位是[1,0,x,9,8,7,6,5,4,3,2]
- 设计时间：2025年10月29日
- 设计人员：向武杰
## 二、类结构说明
### resident_pydantic.py
1. 在`resident_pydantic.py`文件中，定义了一个名为`ResidentPydantic`的类。该类用于表示居民信息的数据模型，包含了居民的基本信息，如姓名、身份证号、出生日期、地址等。
2. `ResidentPydantic`类的属性包括：
   - `name`: 居民姓名，字符串类型，不能为空
   - `id_card`: 居民身份证号，字符串类型，不能为空，格式为17位数字加1位校验位
   - `birth_date`: 居民出生日期，日期类型，不能为空，不能晚于当前日期，也不能早于1900年1月1日
   - `address`: 居民地址，字符串类型，不能为空
### resident_model.py
1. 在`resident_model.py`文件中，定义了一个名为'Resident'的类，和'ResidentManagement'类。
2. 类属性设计（都用私有属性，外面不能直接改）

| 属性名    | 类型 | 访问控制 | 描述          | 验证规则（怎么保证数据合法）|
|-----------|------|----------|---------------|---------------------------------------------|
| `__name`  | str  | 私有     | 居民姓名      | 必须是字符串，不能空、不能全是空格（比如“ 李四”会变成“李四”） |
| `__id_card`| str  | 私有     | 18位身份证号  | 3重验证：18位长度、出生日期合法、校验位正确|
| `__address`| str  | 私有     | 居民住址      | 必须是字符串，不能空、不能全是空格|

3. 核心方法设计（每个方法做什么，怎么保证对）

| 方法名    | 作用       | 输入参数        | 返回值       | 关键逻辑（为什么这么设计）|
|-----------|------------|-----------------|--------------|---------------------------------------------|
| `__init__`| 造居民对象 | name, id_card, address | 无           | 一造对象|
| `name`（`@property`） | 读姓名 | 无 | str | 只能读，不能直接改，防止随便改姓名 |
| `name`（`@setter`） | 改姓名 | value（新姓名） | 无 | 先查是不是空的，空的就报错，合法才给改 |
| `id_card`（`@setter`） | 改身份证号 | value（新身份证号） | 无 | 调用`_validate_id_card`验证，不合法就报错 |
| `_validate_id_card` | 验证身份证号（内部用） | id_card（要验的号） | bool | 按国家 GB11643 - 1999 规则，3 重验证，过了才返回 True |
| `to_json` | 转 JSON 字符串 | 无 | str（JSON） | 只转姓名、身份证号、住址 3 个核心信息，私有属性不对外 |
| `from_json` | 从 JSON 转对象 | json_str（JSON 字符串） | Resident 对象 | 先查 JSON 格式对不对、有没有少信息，合法才造对象 |

4. 辅助类：ResidentManager（居民管理类，管多个居民）
## 三、类关系说明
### resident_model.py
1. `Resident`类是核心类，负责表示和操作居民信息。
2. `ResidentManager`类是辅助类，负责管理多个居民对象，提供添加、删除、查询等操作。
### resident_pydantic.py
1. `ResidentPydantic`类是Pydantic模型类，用于验证和序列化居民信息数据。
